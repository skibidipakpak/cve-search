function saveComment(id, entity, product) {
    var comment = document.getElementById('comment'+id+entity+product).value;
    if (comment != null) {
        data = {'comment': comment, 'id': id, 'entity': entity, 'product': product}
        $.ajax({
            type: "post",
            url: '/save_comment',
            data: JSON.stringify(data),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function(response) {
                parseStatus(response['status'])
            },
            error: function(xhr, ajaxOptions, thrownError) {
                showMessage(thrownError, "error")
            }
        });
    } 
}

function switchStatus(id, entity, product) {
    data = {'id': id, 'entity': entity, 'product': product}
    $.ajax({
        type: "post",
        url: '/switch_status',
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(response) {
            parseStatus(response['status'])
        },
        error: function(xhr, ajaxOptions, thrownError) {
            showMessage(thrownError, "error")
        }
    });
} 

function delete_from_watchlist(id, entity, product) {
    var r = confirm("Delete CVE from watchlist?");
    if (r == false) {
        return;
    } 
    data = {'id': id, 'entity': entity, 'product': product}
    $.ajax({
        type: "post",
        url: '/delete_from_watchlist',
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(response) {
            parseStatus(response['status'])
        },
        error: function(xhr, ajaxOptions, thrownError) {
            showMessage(thrownError, "error")
        }
    });
} 

function exportCSV() {
    var table = $('#CVEs').DataTable();
 
    var tableData = table.rows().data();
 
    data = {'data':tableData}
    $.ajax({
        type: "post",
        url: '/exportCSV',
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(response) {
            parseStatus(response['status'])
            Download("static/export/export.csv")
        },
        error: function(xhr, ajaxOptions, thrownError) {
            showMessage(thrownError, "error")
        }
    });
}

function Download(url) {
    document.getElementById('my_iframe').src = url;
};

