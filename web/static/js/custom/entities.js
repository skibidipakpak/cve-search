function addEntity() {
    var entityName = document.getElementById("add_entity_name").value;
    if (entityName.length == 0) {
        showMessage("Entity name cannot be empty", "error")
    } else {
        data = {"entity_name": entityName};
        $.ajax({
        type: "post",
        url: "/admin/add_entity",
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
            success: function(response) {
                parseStatus(response['status'])
                setInterval('location.reload()', 2000);
            },
            error: function(xhr, ajaxOptions, thrownError) {
                showMessage(thrownError, "error")
            }
        });
    }
  }
  
  function removeEntity() {
    var entityName = document.getElementById("entities").value;
    data = {"entity_name": entityName};
    $.ajax({
      type: "post",
      url: "/admin/remove_entity",
      data: JSON.stringify(data),
      contentType: "application/json; charset=utf-8",
      dataType: "json",
          success: function(response) {
              parseStatus(response['status'])
              setInterval('location.reload()', 2000);
          },
          error: function(xhr, ajaxOptions, thrownError) {
              showMessage(thrownError, "error")
          }
    });
  }
  
  function addEntityCpe() {
    var entityName = document.getElementById("entities_cpe").value;
    var cpe = document.getElementById("cpe").value;
    var found = cpe.match("cpe:2.3:[aoh]:[a-z%-9;-_~]+(?::[a-z%-9;-_~]+)?")
    if (found === null) {
      showMessage("The CPE format is invalid, only simple CPE is supported for now", "error")
    } else {
      data = {"entity_name": entityName, "cpe": cpe};
      $.ajax({
        type: "post",
        url: "/admin/add_entity_cpe",
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
            success: function(response) {
                parseStatus(response['status'])
                setInterval('location.reload()', 2000);
            },
            error: function(xhr, ajaxOptions, thrownError) {
                showMessage(thrownError, "error")
            }
      });
    }
  }