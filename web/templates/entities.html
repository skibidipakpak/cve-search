{% extends 'layouts/master-page.html' %}
{% block title %}{{ listType }} management{% endblock %}
{% block head %}
<!-- css -->
<link href="/static/css/custom/admin.css" rel="stylesheet" />
<link href="/static/css/custom/entities.css" rel="stylesheet" />
<script type="text/javascript" src="/static/js/custom/entities.js"></script>
{% endblock %}
{% block content %}
{% include 'subpages/breadcrumbs.html' %}
<div class="row">
    <!-- Add entity -->
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <strong>Add entity</strong>
            </div>
            <div class="card-body">
                <table class="admin_table">
                    <tr><td class="input_padding_right">Entity name </td><td><input type="text" class="form-control" name="add_entity_name" id="add_entity_name"> </td></tr>
                </table>
                <button class="btn btn-success btn-sm" onclick="addEntity()">Add</button>
            </div>
        </div>
    </div>
    <!-- Remove entity -->
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
            <strong>Remove entity</strong>
            </div>
            <div class="card-body">
            <table class="admin_table">
                <tr>
                <td class="input_padding_right"><label for="entities">Choose an entity</label></td>
                <td>
                    <select id="entities" name="entities">
                    {% for entity in data %}
                        <option value="{{ entity.name }}">{{ entity.name }}</option>
                    {% endfor %}
                    </select> 
                </td>
                </tr>
            </table>
            <button class="btn btn-danger btn-sm" onclick="removeEntity()">Remove</button>
            </div>
        </div>
    </div>
    <!-- Add cpe to entity -->
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
            <strong>Add cpe to an entity</strong>
            </div>
            <div class="card-body">
            <table class="admin_table">
                <tr>
                <td class="input_padding_right"><label for="entities_cpe">Choose an entity</label></td>
                <td>
                    <select id="entities_cpe" name="entities_cpe">
                    {% for entity in data %}
                        <option value="{{ entity.name }}">{{ entity.name }}</option>
                    {% endfor %}
                    </select> 
                </td>
                </tr>
                <tr><td class="input_padding_right">CPE</td> <td><input type="text" class="form-control" name="cpe" id="cpe" placeholder="cpe:2.3:o:microsoft"></td></tr>
            </table>
            <button class="btn btn-success btn-sm" onclick="addEntityCpe()">Add</button>
            </div>
        </div>
    </div>
    
</div>
<br>

<!-- Display entities and cpe -->
<table class="table table-hover">
    <thead class="thead-dark">
      <tr>
        <th width="100%">Entities</th>
      </tr>
    </thead>
    <tbody>
        {% for entity in data %}
        <tr>
            <td><button class="btn btn-light" data-toggle="collapse" data-target="#{{ entity.name }}">{{ entity.name }}</button></td>
        </tr>
        <tr id="{{ entity.name }}" class="collapse">
            <td>
                {% for cpe in entity.cpes %}
                <div id="{{entity.name}}_{{cpe}}">
                    <button data-toggle="tooltip" data-placement="top" title="Delete CPE" type="button" class="btn btn-secondary btn-sm" onclick="delete_cpe('{{ entity.name }}', '{{ cpe }}')"><i class="fas fa-trash-alt"></i></button> {{ cpe }}<br>
                </div>
                {%  endfor %}
            </td>      
        </tr>
        {% endfor %}
    </tbody>
</table>



{% endblock %}
