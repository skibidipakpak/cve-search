{% extends 'layouts/master-page.html' %}
{% block title %}Entity browsing{% endblock %}
{% block head %}
<!-- css -->
<link href="/static/css/custom/browse.css" rel="stylesheet" />
{% endblock %}
{% block content %}
  <!-- breadcrumb -->
{% include 'subpages/breadcrumbs.html' %}
  <!-- browse -->
  {% for cpe, cves in data.items() %}
  <h1>{{ cpe }}</h1>
  <table id="CVEs" class="table table-hover table-striped">
    <thead class="thead-dark">
      <tr>
        <th width="2%"></th>
        <th width="6%">ID</th>
        <th width="3%">CVSS</th>
        <th width="3%">CVSS3</th>
        <th width="60%">Summary</th>
        <th width="11%">Last (major) update</th>
        <th width="11%">Published</th>
      </tr>
    </thead>
    <tbody>
      {% for cve in cves %}
        <tr id ="{{ cve['id'] }}" class="" {{'style=color:'+c['color'] if 'color' in cve else ''}}>
          <td>
            {% if 'icon' in cve %}
              <i class="{{cve['icon']}}"></i>
            {% endif %}
          </td>
          <td data-type="ID">
            <a href="/cve/{{ cve['id'] }}">{{ cve['id'] }}</a>
            {% if 'reason' in cve %}
              <br /><span class="badge badge-success">{{cve['reason']}}</span>
            {% endif %}
          </td>
          <td data-type="CVSS" data-value="{{ cve['cvss'] }}">
            {{ cve['cvss'] }}
          </td>
          <td data-type="CVSS3" data-value="{{ cve['cvss3'] }}">
            {{ cve['cvss3'] }}
          </td>
          <td data-type="SUMMARY">
            <div rel="tooltip" title="{{ cve['summary'] }}">
              {{ cve['summary'][:250] }}
            </div>
          </td>
          <td data-type="MODIFIED" data-value="{{ cve['Modified'].strftime('%Y/%m/%d') }}">
            {{ cve['Modified'].strftime('%Y-%m-%d - %H:%M') }}
          </td>
          <td data-type="PUBLISHED" data-value="{{ cve['Published'].strftime('%Y/%m/%d')}}">
            {{ cve['Published'].strftime('%Y-%m-%d - %H:%M') }}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  {% endfor %}

{% endblock %}
